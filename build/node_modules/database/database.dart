import 'package:postgres/postgres.dart';
import 'package:dotenv/dotenv.dart';

final _env = DotEnv()..load();

PostgreSQLConnection? _connection;

Future<PostgreSQLConnection> openDbConnection() async {
  _connection = PostgreSQLConnection(
    _env['DB_HOST']!,
    int.parse(_env['DB_PORT']!),
    _env['DB_NAME']!,
    username: _env['DB_USER']!,
    password: _env['DB_PASSWORD']!,
    useSSL: true, // NeonDB requires SSL
  );
  await _connection!.open();
  return _connection!;
}

Future<void> closeDbConnection() async {
  if (_connection != null && !_connection!.isClosed) {
    await _connection!.close();
  }
}
